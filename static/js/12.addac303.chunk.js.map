{"version":3,"sources":["pages/map/index.module.css","utils/axios.js","utils/currentCity.js","pages/map/index.js","utils/api/area/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../node_modules/antd-mobile/lib/nav-bar/style/css.js","../node_modules/antd-mobile/lib/nav-bar/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","components/HouseItem/index.js","components/HouseItem/index.module.css","utils/api/house/index.js"],"names":["module","exports","BaseURL","api","axios","create","baseURL","interceptors","request","use","config","url","headers","startsWith","includes","authorization","getToken","loading","error","Promise","reject","response","res","status","data","description","body","hide","setToken","localStorage","setItem","getItem","removeToken","removeItem","isAuth","setSession","sessionStorage","JSON","stringify","getSession","currCity","parse","getCurrCity","a","currCityByLocal","resolve","window","BMap","LocalCity","get","result","name","currCityByMap","resove","getCityInfo","index","state","list","isShowList","initMap","map","Map","addEventListener","setState","value","label","Geocoder","getPoint","point","centerAndZoom","addControl","NavigationControl","ScaleControl","renderOverlays","id","getMapHouses","getTypeAndZoom","type","nextLevel","forEach","item","createOverlays","createRect","createCircle","coord","longitude","latitude","areaName","count","opts","position","Point","offset","Size","Label","setContent","styles","rect","housename","housenum","arrow","setStyle","border","e","moveToCenter","handlerHouseList","addOverlay","ipoint","bubble","bubbleName","setTimeout","clearOverlays","currZoom","getZoom","getHouses","renderHouseList","className","houseList","show","join","titleWrap","listTitle","titleMore","href","houseItems","onClick","props","history","push","houseCode","key","src","Base_URL","houseImg","title","desc","tags","price","changedTouches","clientX","clientY","x","innerWidth","y","innerHeight","panBy","this","mode","icon","onLeftClick","goBack","Component","params","getCities","level","getHotCity","getCommunity","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","_objectSpread2","target","i","arguments","length","source","getOwnPropertyDescriptors","defineProperties","defineProperty","require","_extends3","_interopRequireDefault","_classCallCheck3","_createClass3","_possibleConstructorReturn3","_inherits3","_classnames2","React","obj","__esModule","newObj","prototype","hasOwnProperty","call","_interopRequireWildcard","__rest","s","t","p","indexOf","NavBar","_React$Component","__proto__","getPrototypeOf","_a","prefixCls","children","leftContent","rightContent","restProps","createElement","role","defaultProps","_defineProperty","configurable","writable","HouseItem","style","house","imgWrap","img","alt","content","tag","tagClass","priceNum","getHousesCondition","cityId","filters","start","end","getHousesById"],"mappings":"wGACAA,EAAOC,QAAU,CAAC,OAAS,oBAAoB,WAAa,wBAAwB,KAAO,kBAAkB,MAAQ,mBAAmB,UAAY,uBAAuB,SAAW,sBAAsB,UAAY,uBAAuB,KAAO,kBAAkB,UAAY,uBAAuB,UAAY,uBAAuB,UAAY,uBAAuB,WAAa,0B,sHCIxXC,EAAU,oCAEVC,EAAMC,IAAMC,OAAO,CACvBC,QAASJ,IAIXC,EAAII,aAAaC,QAAQC,KACvB,SAAUC,GAAS,IACTC,EAAiBD,EAAjBC,IAAKC,EAAYF,EAAZE,QAWb,OARID,EAAIE,WAAW,WAFN,CAAC,mBAAoB,eAEGC,SAASH,KAE5CC,EAAQG,cAAgBC,eAI1B,IAAMC,QAAQ,wBAAU,GAEjBP,KAET,SAAUQ,GAER,OAAOC,QAAQC,OAAOF,MAK1Bf,EAAII,aAAac,SAASZ,KACxB,SAAUY,GAER,IAAIC,EAAM,CACRC,OAAQF,EAASG,KAAKD,OACtBE,YAAaJ,EAASG,KAAKC,YAC3BD,KAAMH,EAASG,KAAKE,MAItB,OADA,IAAMC,OACCL,KAET,SAAUJ,GAGR,OAAOC,QAAQC,OAAOF,MAIXf,O,iRC/CTyB,EAAW,SAACJ,GAChBK,aAAaC,QAJI,QAIgBN,IAI7BR,EAAW,WAEf,OADYa,aAAaE,QATR,UAcbC,EAAc,WAClBH,aAAaI,WAfI,UAmBbC,EAAS,mBAAQlB,KAGjBmB,EAAa,SAACX,GAClBY,eAAeN,QAxBC,WAwBkBO,KAAKC,UAAUd,KAI7Ce,EAAa,WACjB,IAAIC,EAAWJ,eAAeL,QA7Bd,YA8BhB,OAAOS,EACAH,KAAKI,MAAMD,GADM,MAsBpBE,EAAW,uCAAG,8BAAAC,EAAA,6DAEZC,EAAkBL,IAFN,SAXX,IAAIpB,SAAQ,SAAC0B,EAASzB,IAEZ,IAAI0B,OAAOC,KAAKC,WACxBC,KAAI,SAACC,GAEVL,EAAQK,EAAOC,YAMD,UAKZC,EALY,OAabR,EAba,yCAcT,IAAIzB,QAAJ,uCAAY,WAAOkC,EAAQjC,GAAf,mBAAAuB,EAAA,sEAEcW,YAAYF,GAF1B,gBAET7B,EAFS,EAETA,OAAQC,EAFC,EAEDA,KACD,MAAXD,GAEFY,EAAWX,GAEX6B,EAAO7B,IAEPJ,EAAO,SATQ,2CAAZ,0DAdS,gCA4BTD,QAAQ0B,QAAQD,IA5BP,2CAAH,sD,wOCzCXW,E,4MACJC,MAAQ,CACNC,KAAM,GACNC,YAAY,G,EASdC,Q,sBAAU,gCAAAhB,EAAA,6DACR,EAAKI,KAAOD,OAAOC,KAEnB,EAAKa,IAAM,IAAI,EAAKb,KAAKc,IAAI,aAC7B,EAAKD,IAAIE,iBAAiB,aAAa,WACjC,EAAKN,MAAME,YACb,EAAKK,SAAS,CACZL,YAAY,OAPV,SAYuBhB,cAZvB,gBAYAsB,EAZA,EAYAA,MAAOC,EAZP,EAYOA,OAEH,IAAI,EAAKlB,KAAKmB,UAGpBC,SACJ,KADF,uCAEE,WAAOC,GAAP,SAAAzB,EAAA,sDACMyB,IAEF,EAAKR,IAAIS,cAAcD,EAAO,IAE9B,EAAKR,IAAIU,WAAW,IAAI,EAAKvB,KAAKwB,mBAClC,EAAKX,IAAIU,WAAW,IAAI,EAAKvB,KAAKyB,cAGlC,EAAKC,eAAeT,IATxB,2CAFF,sDAcEC,GA/BM,4C,EAoCVQ,e,uCAAiB,WAAOC,GAAP,yBAAA/B,EAAA,sEACcgC,YAAaD,GAD3B,gBACTnD,EADS,EACTA,OAAQC,EADC,EACDA,KADC,EAEa,EAAKoD,iBAAzBC,EAFO,EAEPA,KAAMC,EAFC,EAEDA,UACC,MAAXvD,GACFC,EAAKuD,SAAQ,SAACC,GACZ,EAAKC,eAAeJ,EAAMC,EAAWE,MAL1B,2C,wDAWjBC,eAAiB,SAACJ,EAAMC,EAAWE,GACpB,SAATH,EAEF,EAAKK,WAAWF,GAGhB,EAAKG,aAAaL,EAAWE,I,EAKjCE,WAAa,SAACF,GAAU,IAAD,EAMjBA,EAJFI,MAASC,EAFU,EAEVA,UAAWC,EAFD,EAECA,SACbC,EAGLP,EAHFf,MACAuB,EAEER,EAFFQ,MACAxB,EACEgB,EADFhB,MAKIyB,EAAO,CACXC,SAHa,IAAI,EAAK3C,KAAK4C,MAAMN,EAAWC,GAI5CM,OAAQ,IAAI,EAAK7C,KAAK8C,MAAM,IAAK,KAE7B5B,EAAQ,IAAI,EAAKlB,KAAK+C,MAAM,KAAML,GACxCxB,EAAM8B,WAAN,8BAEgBC,IAAOC,KAFvB,oCAGmBD,IAAOE,UAH1B,aAGwCX,EAHxC,yCAImBS,IAAOG,SAJ1B,aAIuCX,EAJvC,sCAKgBQ,IAAOI,MALvB,iCASAnC,EAAMoC,SAAS,CACbC,OAAQ,SAGVrC,EAAMH,iBAAiB,SAAS,SAACyC,GAC/B,EAAKC,aAAaD,GAClB,EAAKE,iBAAiBzC,MAExB,EAAKJ,IAAI8C,WAAWzC,I,EAItBkB,aAAe,SAACL,EAAWE,GAAU,IAAD,EAM9BA,EAJFI,MAASC,EAFuB,EAEvBA,UAAWC,EAFY,EAEZA,SACbC,EAGLP,EAHFf,MACAuB,EAEER,EAFFQ,MACAxB,EACEgB,EADFhB,MAGI2C,EAAS,IAAI,EAAK5D,KAAK4C,MAAMN,EAAWC,GAExCG,EAAO,CACXC,SAAUiB,EACVf,OAAQ,IAAI,EAAK7C,KAAK8C,KAAK,EAAG,IAE1B5B,EAAQ,IAAI,EAAKlB,KAAK+C,MAAM,KAAML,GACxCxB,EAAM8B,WAAN,gCAEkBC,IAAOY,OAFzB,mCAGkBZ,IAAOa,WAHzB,aAGwCtB,EAHxC,8BAIWC,EAJX,uCAQAvB,EAAMoC,SAAS,CACbC,OAAQ,SAGVrC,EAAMH,iBAAiB,SAAS,WAE9B,EAAKF,IAAIS,cAAcsC,EAAQ7B,GAE/B,EAAKL,eAAeT,GAEpB8C,YAAW,kBAAM,EAAKlD,IAAImD,sBAE5B,EAAKnD,IAAI8C,WAAWzC,I,EAQtBW,eAAiB,WACf,IAAIC,EAAMC,EAEJkC,EAAW,EAAKpD,IAAIqD,UAa1B,OAZID,GAAY,IAAMA,EAAW,IAE/BnC,EAAO,SACPC,EAAY,IACHkC,GAAY,IAAMA,EAAW,IAEtCnC,EAAO,SACPC,EAAY,IACHkC,GAAY,IAAMA,EAAW,KAEtCnC,EAAO,QAEF,CACLA,OACAC,c,EAMJ2B,iB,uCAAmB,WAAO/B,GAAP,eAAA/B,EAAA,sEACDuE,YAAUxC,GADT,OAEE,OADfpD,EADa,QAETC,QACN,EAAKwC,SAAS,CACZN,KAAMnC,EAAIE,KAAKiC,KACfC,YAAY,IALC,2C,wDAWnByD,gBAAkB,WAChB,OACE,yBACEC,UAAW,CACTpB,IAAOqB,UACP,EAAK7D,MAAME,WAAasC,IAAOsB,KAAO,IACtCC,KAAK,MAEP,yBAAKH,UAAWpB,IAAOwB,WACrB,wBAAIJ,UAAWpB,IAAOyB,WAAtB,4BACA,uBAAGL,UAAWpB,IAAO0B,UAAWC,KAAK,eAArC,6BAIF,yBAAKP,UAAWpB,IAAO4B,YAEpB,EAAKpE,MAAMC,KAAKG,KAAI,SAACoB,GAAD,OACnB,kBAAC,IAAD,CACE6C,QAAS,kBACP,EAAKC,MAAMC,QAAQC,KAAnB,kBAAmChD,EAAKiD,aAE1CC,IAAKlD,EAAKiD,UACVE,IAAKC,IAAWpD,EAAKqD,SACrBC,MAAOtD,EAAKsD,MACZC,KAAMvD,EAAKuD,KACXC,KAAMxD,EAAKwD,KACXC,MAAOzD,EAAKyD,c,EASxBjC,aAAe,SAACD,GAAO,IAAD,EACOA,EAAEmC,eAAe,GAAtCC,EADc,EACdA,QAASC,EADK,EACLA,QACTC,EAAI/F,OAAOgG,WAAa,EAAIH,EAChCI,GAAKjG,OAAOkG,YAAc,KAAO,EAAIJ,EACvC,EAAKhF,IAAIqF,MAAMJ,EAAGE,I,kEAvNlBG,KAAKvF,Y,+BA0NG,IAAD,OACP,OACE,oCACE,uBACEwF,KAAK,QACLC,KAAM,uBAAMvE,KAAK,SACjBwE,YAAa,WACX,EAAKvB,MAAMC,QAAQuB,WAJvB,4BASA,yBAAK5E,GAAG,cACPwE,KAAK/B,uB,GA/OMoC,aAqPLhG,a,gCClQf,sLAGMD,EAAc,SAACH,GACnB,OAAOhD,IAAI8C,IAAI,aAAc,CAC3BuG,OAAQ,CACNrG,WAMAsG,EAAY,WAAgB,IAAfC,EAAc,uDAAN,EACzB,OAAOvJ,IAAI8C,IAAI,aAAc,CAC3BuG,OAAQ,CACNE,YAMAC,EAAa,WACjB,OAAOxJ,IAAI8C,IAAI,cAIX2G,EAAe,SAACzG,EAAMuB,GAC1B,OAAOvE,IAAI8C,IAAI,kBAAmB,CAChCuG,OAAQ,CACNrG,OACAuB,SAMAC,EAAe,SAACD,GACpB,OAAOvE,IAAI8C,IAAI,YAAa,CAC1BuG,OAAQ,CACN9E,U,gCCvCN,8CAEA,SAASmF,EAAQC,EAAQC,GACvB,IAAIC,EAAOC,OAAOD,KAAKF,GAEvB,GAAIG,OAAOC,sBAAuB,CAChC,IAAIC,EAAUF,OAAOC,sBAAsBJ,GACvCC,IAAgBI,EAAUA,EAAQC,QAAO,SAAUC,GACrD,OAAOJ,OAAOK,yBAAyBR,EAAQO,GAAKE,eAEtDP,EAAKhC,KAAKwC,MAAMR,EAAMG,GAGxB,OAAOH,EAGM,SAASS,EAAeC,GACrC,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAIG,EAAyB,MAAhBF,UAAUD,GAAaC,UAAUD,GAAK,GAE/CA,EAAI,EACNd,EAAQI,OAAOa,IAAS,GAAM/F,SAAQ,SAAUmD,GAC9C,YAAewC,EAAQxC,EAAK4C,EAAO5C,OAE5B+B,OAAOc,0BAChBd,OAAOe,iBAAiBN,EAAQT,OAAOc,0BAA0BD,IAEjEjB,EAAQI,OAAOa,IAAS/F,SAAQ,SAAUmD,GACxC+B,OAAOgB,eAAeP,EAAQxC,EAAK+B,OAAOK,yBAAyBQ,EAAQ5C,OAKjF,OAAOwC,I,gCC/BTQ,EAAQ,IAERA,EAAQ,K,qDCFRjB,OAAOgB,eAAehL,EAAS,aAAc,CACzC+D,OAAO,IAGX,IAEImH,EAAYC,EAFAF,EAAQ,KAMpBG,EAAmBD,EAFAF,EAAQ,KAM3BI,EAAgBF,EAFAF,EAAQ,KAMxBK,EAA8BH,EAFAF,EAAQ,KAMtCM,EAAaJ,EAFAF,EAAQ,KAMrBO,EAAeL,EAFDF,EAAQ,KAMtBQ,EAEJ,SAAiCC,GAAO,GAAIA,GAAOA,EAAIC,WAAc,OAAOD,EAAc,IAAIE,EAAS,GAAI,GAAW,MAAPF,EAAe,IAAK,IAAIzD,KAAOyD,EAAW1B,OAAO6B,UAAUC,eAAeC,KAAKL,EAAKzD,KAAM2D,EAAO3D,GAAOyD,EAAIzD,IAAmC,OAAzB2D,EAAM,QAAcF,EAAYE,EAFzPI,CAFCf,EAAQ,IAMrB,SAASE,EAAuBO,GAAO,OAAOA,GAAOA,EAAIC,WAAaD,EAAM,CAAE,QAAWA,GAEzF,IAAIO,EAA0C,SAAUC,EAAG5F,GACvD,IAAI6F,EAAI,GACR,IAAK,IAAIC,KAAKF,EACNlC,OAAO6B,UAAUC,eAAeC,KAAKG,EAAGE,IAAM9F,EAAE+F,QAAQD,GAAK,IAAGD,EAAEC,GAAKF,EAAEE,IAChF,GAAS,MAALF,GAAqD,oBAAjClC,OAAOC,sBAA2C,KAAIS,EAAI,EAAb,IAAgB0B,EAAIpC,OAAOC,sBAAsBiC,GAAIxB,EAAI0B,EAAExB,OAAQF,IACjIpE,EAAE+F,QAAQD,EAAE1B,IAAM,IAAGyB,EAAEC,EAAE1B,IAAMwB,EAAEE,EAAE1B,KAC1C,OAAOyB,GAGRG,EAAS,SAAUC,GAGnB,SAASD,IAEL,OADA,EAAIlB,EAAgB,SAAanC,KAAMqD,IAChC,EAAIhB,EAA2B,SAAarC,MAAOqD,EAAOE,WAAaxC,OAAOyC,eAAeH,IAAS/B,MAAMtB,KAAM0B,YA4C7H,OAhDA,EAAIY,EAAU,SAAae,EAAQC,IAOnC,EAAIlB,EAAa,SAAaiB,EAAQ,CAAC,CACnCrE,IAAK,SACLlE,MAAO,WACH,IAAI2I,EAAKzD,KAAKpB,MACV8E,EAAYD,EAAGC,UACfxF,EAAYuF,EAAGvF,UACfyF,EAAWF,EAAGE,SACd1D,EAAOwD,EAAGxD,KACVC,EAAOuD,EAAGvD,KACVC,EAAcsD,EAAGtD,YACjByD,EAAcH,EAAGG,YACjBC,EAAeJ,EAAGI,aAClBC,EAAYd,EAAOS,EAAI,CAAC,YAAa,YAAa,WAAY,OAAQ,OAAQ,cAAe,cAAe,iBAChH,OAAOjB,EAAMuB,cACT,OACA,EAAI9B,EAAS,SAAa,GAAI6B,EAAW,CAAE5F,WAAW,EAAIqE,EAAY,SAAarE,EAAWwF,EAAWA,EAAY,IAAMzD,KAC3HuC,EAAMuB,cACF,MACA,CAAE7F,UAAWwF,EAAY,QAASM,KAAM,SAAUrF,QAASwB,GAC3DD,EAEAsC,EAAMuB,cACF,OACA,CAAE7F,UAAWwF,EAAY,aAAc,cAAe,QACtDxD,GACA,KACJ0D,GAEJpB,EAAMuB,cACF,MACA,CAAE7F,UAAWwF,EAAY,UACzBC,GAEJnB,EAAMuB,cACF,MACA,CAAE7F,UAAWwF,EAAY,UACzBG,QAKTR,EAjDE,CAkDXb,EAAMnC,WAERtJ,EAAO,QAAcsM,EAErBA,EAAOY,aAAe,CAClBP,UAAW,YACXzD,KAAM,OACNE,YAAa,cAEjBrJ,EAAOC,QAAUA,EAAO,S,gCC1GT,SAASmN,EAAgBzB,EAAKzD,EAAKlE,GAYhD,OAXIkE,KAAOyD,EACT1B,OAAOgB,eAAeU,EAAKzD,EAAK,CAC9BlE,MAAOA,EACPuG,YAAY,EACZ8C,cAAc,EACdC,UAAU,IAGZ3B,EAAIzD,GAAOlE,EAGN2H,EAZT,mC,gCCAA,qCAoDe4B,IA1Cf,YAAuE,IAAlDpF,EAAiD,EAAjDA,IAAKG,EAA4C,EAA5CA,MAAOC,EAAqC,EAArCA,KAAMC,EAA+B,EAA/BA,KAAMC,EAAyB,EAAzBA,MAAOZ,EAAkB,EAAlBA,QAAS2F,EAAS,EAATA,MAG3D,OACE,yBAAKpG,UAAWpB,IAAOyH,MAAO5F,QAASA,EAAS2F,MAAOA,GACrD,yBAAKpG,UAAWpB,IAAO0H,SACrB,yBAAKtG,UAAWpB,IAAO2H,IAAKxF,IAAKA,EAAKyF,IAAI,MAE5C,yBAAKxG,UAAWpB,IAAO6H,SACrB,wBAAIzG,UAAWpB,IAAOsC,OAAQA,GAC9B,yBAAKlB,UAAWpB,IAAOuC,MAAOA,GAC9B,6BAEGC,EAAK5E,KAAI,SAACkK,EAAKvK,GACd,IAAMwK,EAAW,OAASxK,EAAQ,GAClC,OACE,0BACE6D,UAAW,CAACpB,IAAO8H,IAAK9H,IAAO+H,IAAWxG,KAAK,KAC/CW,IAAK4F,GAEJA,OAKT,yBAAK1G,UAAWpB,IAAOyC,OACrB,0BAAMrB,UAAWpB,IAAOgI,UAAWvF,GADrC,sB,mBClCRzI,EAAOC,QAAU,CAAC,MAAQ,yBAAyB,QAAU,2BAA2B,IAAM,uBAAuB,QAAU,2BAA2B,MAAQ,yBAAyB,KAAO,wBAAwB,MAAQ,yBAAyB,SAAW,4BAA4B,IAAM,uBAAuB,KAAO,wBAAwB,KAAO,wBAAwB,KAAO,0B,0JCE9XgO,EAAqB,SAACvJ,GAC1B,OAAOvE,IAAI8C,IAAI,oBAAqB,CAClCuG,OAAQ,CACN9E,SAMAwC,EAAY,SAACgH,EAAQC,EAASC,EAAOC,GACzC,OAAOlO,IAAI8C,IAAI,UAAW,CACxBuG,OAAO,aACL0E,UACGC,EAFC,CAGJC,QACAC,WAMAC,EAAgB,SAAC5J,GACrB,OAAOvE,IAAI8C,IAAJ,kBAAmByB","file":"static/js/12.addac303.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"bubble\":\"map_bubble__3EuEa\",\"bubbleName\":\"map_bubbleName__1nl9A\",\"rect\":\"map_rect__3cZHb\",\"arrow\":\"map_arrow__29M9X\",\"housename\":\"map_housename__1F9HU\",\"housenum\":\"map_housenum__1S8R2\",\"houseList\":\"map_houseList__3aAw7\",\"show\":\"map_show__16HMB\",\"titleWrap\":\"map_titleWrap__oFC0Z\",\"listTitle\":\"map_listTitle__2RZm6\",\"titleMore\":\"map_titleMore__28l6Q\",\"houseItems\":\"map_houseItems__1MnpO\"};","import axios from \"axios\";\r\nimport { Toast } from \"antd-mobile\";\r\nimport { getToken } from \"./currentCity\";\r\n\r\n// 基地址\r\nconst BaseURL = \"https://api-haoke-web.itheima.net\";\r\n\r\nconst api = axios.create({\r\n  baseURL: BaseURL,\r\n});\r\n\r\n// Add a request interceptor  请求拦截器\r\napi.interceptors.request.use(\r\n  function (config) {\r\n    const { url, headers } = config;\r\n    const list = [\"/user/registered\", \"/user/login\"]; // 白名单\r\n\r\n    if (url.startsWith(\"/user\") && !list.includes(url)) {\r\n      // 设置公共请求头\r\n      headers.authorization = getToken();\r\n    }\r\n\r\n    // 动画加载\r\n    Toast.loading(\"加载中...\", 0);\r\n    // Do something before request is sent\r\n    return config;\r\n  },\r\n  function (error) {\r\n    // Do something with request error\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add a response interceptor  响应拦截器\r\napi.interceptors.response.use(\r\n  function (response) {\r\n    // 简化返回结果\r\n    let res = {\r\n      status: response.data.status,\r\n      description: response.data.description,\r\n      data: response.data.body,\r\n    };\r\n    // 动画结束\r\n    Toast.hide();\r\n    return res;\r\n  },\r\n  function (error) {\r\n    // Any status codes that falls outside the range of 2xx cause this function to trigger\r\n    // Do something with response error\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\nexport { BaseURL };\r\n","import { getCityInfo } from \"./api/area\";\r\n\r\nconst CURR_CITY = \"currCity\"; // 当前城市\r\nconst USER_TOKEN = \"token\";\r\n\r\n// 设置Token\r\nconst setToken = (data) => {\r\n  localStorage.setItem(USER_TOKEN, data);\r\n};\r\n\r\n// 获取Token\r\nconst getToken = () => {\r\n  let token = localStorage.getItem(USER_TOKEN);\r\n  return token;\r\n};\r\n\r\n// 删除Token\r\nconst removeToken = () => {\r\n  localStorage.removeItem(USER_TOKEN);\r\n};\r\n\r\n// 是否登录判断：boolean\r\nconst isAuth = () => !!getToken();\r\n\r\n// 设置当前城市\r\nconst setSession = (data) => {\r\n  sessionStorage.setItem(CURR_CITY, JSON.stringify(data));\r\n};\r\n\r\n// 获取当前城市\r\nconst getSession = () => {\r\n  let currCity = sessionStorage.getItem(CURR_CITY);\r\n  if (!!!currCity) return null;\r\n  return JSON.parse(currCity);\r\n};\r\n\r\n// 删除当前城市\r\n// const removeSession = () => {\r\n//   sessionStorage.removeItem(CURR_CITY);\r\n// };\r\n\r\n// 百度获取\r\nconst getCurrCityByMap = () => {\r\n  return new Promise((resolve, reject) => {\r\n    // 使用百度地图LocalCity获取当前的城市名称\r\n    const myCity = new window.BMap.LocalCity();\r\n    myCity.get((result) => {\r\n      // 根据百度地图获取到城市名字，调用后台接口获取当前城市的详细数据\r\n      resolve(result.name);\r\n    });\r\n  });\r\n};\r\n\r\n// 获取当前城市信息\r\nconst getCurrCity = async () => {\r\n  // 内存中找\r\n  const currCityByLocal = getSession();\r\n\r\n  // 定位\r\n  const currCityByMap = await getCurrCityByMap();\r\n  // 内存中没有 || 内存中有键没值 || 定位和内存中的值不匹配  这样判断，手动切换城市就会有bug\r\n  // if (\r\n  //   !currCityByLocal ||\r\n  //   !currCityByLocal.label ||\r\n  //   !currCityByMap.includes(currCityByLocal.label)\r\n  // ) {\r\n\r\n  if (!currCityByLocal) {\r\n    return new Promise(async (resove, reject) => {\r\n      // 调用接口获取城市详细信息\r\n      const { status, data } = await getCityInfo(currCityByMap);\r\n      if (status === 200) {\r\n        // 存到本地\r\n        setSession(data);\r\n        // 传递数据\r\n        resove(data);\r\n      } else {\r\n        reject(\"error\");\r\n      }\r\n    });\r\n  } else {\r\n    // 如果有，返回本地存储获取的信息\r\n    return Promise.resolve(currCityByLocal);\r\n  }\r\n};\r\n\r\nexport {\r\n  getCurrCity,\r\n  setSession,\r\n  CURR_CITY,\r\n  setToken,\r\n  getToken,\r\n  removeToken,\r\n  isAuth,\r\n};\r\n","import React, { Component } from \"react\";\r\n\r\nimport { NavBar, Icon } from \"antd-mobile\";\r\n\r\nimport \"./index.scss\";\r\n\r\nimport { getCurrCity } from \"../../utils/currentCity\";\r\nimport styles from \"./index.module.css\";\r\nimport { getMapHouses } from \"../../utils/api/area\";\r\nimport { getHouses } from \"../../utils/api/house\";\r\nimport HouseItem from \"../../components/HouseItem\";\r\nimport { BaseURL as Base_URL } from \"../../utils/axios\";\r\n\r\nclass index extends Component {\r\n  state = {\r\n    list: [],\r\n    isShowList: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    // 初始化地图\r\n    this.initMap();\r\n  }\r\n\r\n  // 初始化地图\r\n  initMap = async () => {\r\n    this.BMap = window.BMap;\r\n    // 创建地图实例\r\n    this.map = new this.BMap.Map(\"container\");\r\n    this.map.addEventListener(\"movestart\", () => {\r\n      if (this.state.isShowList) {\r\n        this.setState({\r\n          isShowList: false,\r\n        });\r\n      }\r\n    });\r\n    // 获取定位城市\r\n    const { value, label } = await getCurrCity();\r\n    // 创建地址解析器实例\r\n    let myGeo = new this.BMap.Geocoder();\r\n\r\n    // 将地址解析结果显示在地图上，并调整地图视野\r\n    myGeo.getPoint(\r\n      null,\r\n      async (point) => {\r\n        if (point) {\r\n          // 初始化地图，设置中心点坐标和地图级别\r\n          this.map.centerAndZoom(point, 11);\r\n          // 添加控件\r\n          this.map.addControl(new this.BMap.NavigationControl());\r\n          this.map.addControl(new this.BMap.ScaleControl());\r\n\r\n          // 调用后台接口获取覆盖物数据\r\n          this.renderOverlays(value);\r\n        }\r\n      },\r\n      label\r\n    );\r\n  };\r\n\r\n  // 封装渲染覆盖物\r\n  renderOverlays = async (id) => {\r\n    let { status, data } = await getMapHouses(id);\r\n    const { type, nextLevel } = this.getTypeAndZoom();\r\n    if (status === 200) {\r\n      data.forEach((item) => {\r\n        this.createOverlays(type, nextLevel, item);\r\n      });\r\n    }\r\n  };\r\n\r\n  // 根据当前覆盖物的类型，决定调用哪个方法创建覆盖物\r\n  createOverlays = (type, nextLevel, item) => {\r\n    if (type === \"rect\") {\r\n      // 小区\r\n      this.createRect(item);\r\n    } else {\r\n      // 区和镇\r\n      this.createCircle(nextLevel, item);\r\n    }\r\n  };\r\n\r\n  // 小区  长方形的\r\n  createRect = (item) => {\r\n    const {\r\n      coord: { longitude, latitude },\r\n      label: areaName,\r\n      count,\r\n      value,\r\n    } = item;\r\n    // 转换地理位置坐标\r\n    const ipoint = new this.BMap.Point(longitude, latitude);\r\n    // 绘制覆盖物\r\n    const opts = {\r\n      position: ipoint, // 指定文本标注所在的地理位置\r\n      offset: new this.BMap.Size(-50, -20), // 设置文本偏移量\r\n    };\r\n    const label = new this.BMap.Label(null, opts);\r\n    label.setContent(\r\n      `\r\n      <div class=\"${styles.rect}\">\r\n        <span class=\"${styles.housename}\">${areaName}</span>\r\n        <span class=\"${styles.housenum}\">${count}</span>\r\n        <i class=\"${styles.arrow}\"></i>\r\n      </div>\r\n      `\r\n    );\r\n    label.setStyle({\r\n      border: \"none\",\r\n    });\r\n    // 添加点击事件\r\n    label.addEventListener(\"click\", (e) => {\r\n      this.moveToCenter(e);\r\n      this.handlerHouseList(value);\r\n    });\r\n    this.map.addOverlay(label);\r\n  };\r\n\r\n  // 区和镇  圆形的\r\n  createCircle = (nextLevel, item) => {\r\n    const {\r\n      coord: { longitude, latitude },\r\n      label: areaName,\r\n      count,\r\n      value,\r\n    } = item;\r\n    // 转换地理位置坐标\r\n    const ipoint = new this.BMap.Point(longitude, latitude);\r\n    // 绘制覆盖物\r\n    const opts = {\r\n      position: ipoint, // 指定文本标注所在的地理位置\r\n      offset: new this.BMap.Size(0, 0), // 设置文本偏移量\r\n    };\r\n    const label = new this.BMap.Label(null, opts);\r\n    label.setContent(\r\n      `\r\n        <div class=\"${styles.bubble}\">\r\n          <p class=\"${styles.bubbleName}\">${areaName}</p>\r\n          <p>${count}套</p>\r\n        </div>\r\n      `\r\n    );\r\n    label.setStyle({\r\n      border: \"none\",\r\n    });\r\n    // 添加点击事件\r\n    label.addEventListener(\"click\", () => {\r\n      // 设置显示下一区域的位置和缩放级别\r\n      this.map.centerAndZoom(ipoint, nextLevel);\r\n      // 渲染下一层覆盖物\r\n      this.renderOverlays(value);\r\n      // 清除第一层覆盖物\r\n      setTimeout(() => this.map.clearOverlays());\r\n    });\r\n    this.map.addOverlay(label);\r\n  };\r\n\r\n  // 计算要绘制的覆盖物类型和下一个缩放级别\r\n  // 区 -> 11  , 范围：>=10 <12\r\n  // 镇 -> 13  , 范围：>=12 <14\r\n  // 小区 -> 15, 范围：>=14 <16\r\n  // 提供地图缩放级别和覆盖物类型\r\n  getTypeAndZoom = () => {\r\n    let type, nextLevel;\r\n    // 获取小区缩放级别\r\n    const currZoom = this.map.getZoom(); // 获取当前缩放级别， 项目中默认缩放级别为：11\r\n    if (currZoom >= 10 && currZoom < 12) {\r\n      // 区\r\n      type = \"circle\";\r\n      nextLevel = 13;\r\n    } else if (currZoom >= 12 && currZoom < 14) {\r\n      // 镇\r\n      type = \"circle\";\r\n      nextLevel = 15;\r\n    } else if (currZoom >= 14 && currZoom < 16) {\r\n      // 小区\r\n      type = \"rect\";\r\n    }\r\n    return {\r\n      type,\r\n      nextLevel,\r\n    };\r\n  };\r\n\r\n  // 获取小区下的房源列表\r\n  // 调用之前定义的根据过滤条件获取房源列表方法，传入cityId\r\n  handlerHouseList = async (id) => {\r\n    let res = await getHouses(id);\r\n    if (res.status === 200) {\r\n      this.setState({\r\n        list: res.data.list,\r\n        isShowList: true,\r\n      });\r\n    }\r\n  };\r\n\r\n  // 渲染小区下房屋列表\r\n  renderHouseList = () => {\r\n    return (\r\n      <div\r\n        className={[\r\n          styles.houseList,\r\n          this.state.isShowList ? styles.show : \"\",\r\n        ].join(\" \")}\r\n      >\r\n        <div className={styles.titleWrap}>\r\n          <h1 className={styles.listTitle}>房屋列表</h1>\r\n          <a className={styles.titleMore} href=\"/home/house\">\r\n            更多房源\r\n          </a>\r\n        </div>\r\n        <div className={styles.houseItems}>\r\n          {/* 房屋结构 */}\r\n          {this.state.list.map((item) => (\r\n            <HouseItem\r\n              onClick={() =>\r\n                this.props.history.push(`/detail/${item.houseCode}`)\r\n              }\r\n              key={item.houseCode}\r\n              src={Base_URL + item.houseImg}\r\n              title={item.title}\r\n              desc={item.desc}\r\n              tags={item.tags}\r\n              price={item.price}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // 移动地图到当前小区位置\r\n  moveToCenter = (e) => {\r\n    let { clientX, clientY } = e.changedTouches[0];\r\n    const x = window.innerWidth / 2 - clientX,\r\n      y = (window.innerHeight - 330) / 2 - clientY;\r\n    this.map.panBy(x, y);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <NavBar\r\n          mode=\"light\"\r\n          icon={<Icon type=\"left\" />}\r\n          onLeftClick={() => {\r\n            this.props.history.goBack();\r\n          }}\r\n        >\r\n          地图找房\r\n        </NavBar>\r\n        <div id=\"container\"></div>\r\n        {this.renderHouseList()}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default index;\r\n","import api from \"../../axios\";\r\n\r\n// 根据城市名称查询该城市的信息\r\nconst getCityInfo = (name) => {\r\n  return api.get(\"/area/info\", {\r\n    params: {\r\n      name,\r\n    },\r\n  });\r\n};\r\n\r\n// 获取城市列表数据\r\nconst getCities = (level = 1) => {\r\n  return api.get(\"/area/city\", {\r\n    params: {\r\n      level,\r\n    },\r\n  });\r\n};\r\n\r\n// 获取热门城市\r\nconst getHotCity = () => {\r\n  return api.get(\"/area/hot\");\r\n};\r\n\r\n// 小区关键词查询\r\nconst getCommunity = (name, id) => {\r\n  return api.get(\"/area/community\", {\r\n    params: {\r\n      name,\r\n      id,\r\n    },\r\n  });\r\n};\r\n\r\n// 查询房源数据\r\nconst getMapHouses = (id) => {\r\n  return api.get(\"/area/map\", {\r\n    params: {\r\n      id,\r\n    },\r\n  });\r\n};\r\n\r\nexport { getCityInfo, getCities, getHotCity, getCommunity, getMapHouses };\r\n","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","'use strict';\n\nrequire('../../style/css');\n\nrequire('./index.css');","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar __rest = undefined && undefined.__rest || function (s, e) {\n    var t = {};\n    for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n    }if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n        if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n    }return t;\n};\n\nvar NavBar = function (_React$Component) {\n    (0, _inherits3['default'])(NavBar, _React$Component);\n\n    function NavBar() {\n        (0, _classCallCheck3['default'])(this, NavBar);\n        return (0, _possibleConstructorReturn3['default'])(this, (NavBar.__proto__ || Object.getPrototypeOf(NavBar)).apply(this, arguments));\n    }\n\n    (0, _createClass3['default'])(NavBar, [{\n        key: 'render',\n        value: function render() {\n            var _a = this.props,\n                prefixCls = _a.prefixCls,\n                className = _a.className,\n                children = _a.children,\n                mode = _a.mode,\n                icon = _a.icon,\n                onLeftClick = _a.onLeftClick,\n                leftContent = _a.leftContent,\n                rightContent = _a.rightContent,\n                restProps = __rest(_a, [\"prefixCls\", \"className\", \"children\", \"mode\", \"icon\", \"onLeftClick\", \"leftContent\", \"rightContent\"]);\n            return React.createElement(\n                'div',\n                (0, _extends3['default'])({}, restProps, { className: (0, _classnames2['default'])(className, prefixCls, prefixCls + '-' + mode) }),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-left', role: 'button', onClick: onLeftClick },\n                    icon ?\n                    // tslint:disable-next-line:jsx-no-multiline-js\n                    React.createElement(\n                        'span',\n                        { className: prefixCls + '-left-icon', 'aria-hidden': 'true' },\n                        icon\n                    ) : null,\n                    leftContent\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-title' },\n                    children\n                ),\n                React.createElement(\n                    'div',\n                    { className: prefixCls + '-right' },\n                    rightContent\n                )\n            );\n        }\n    }]);\n    return NavBar;\n}(React.Component);\n\nexports['default'] = NavBar;\n\nNavBar.defaultProps = {\n    prefixCls: 'am-navbar',\n    mode: 'dark',\n    onLeftClick: function onLeftClick() {}\n};\nmodule.exports = exports['default'];","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import React from \"react\";\r\n\r\n// import PropTypes from \"prop-types\";\r\n// props\r\n// 1. cheldren -> 获取组件动态内容  <Child>adadsd</Child>\r\n// 2. defautProps -> 为组件设置默认属性  num\r\n// 3. prop-types -> 为组件的属性提供默认类型  age\r\n\r\nimport styles from \"./index.module.css\";\r\n\r\nfunction HouseItem({ src, title, desc, tags, price, onClick, style }) {\r\n  // console.log(src, title, desc, tags, price, onClick, style);\r\n\r\n  return (\r\n    <div className={styles.house} onClick={onClick} style={style}>\r\n      <div className={styles.imgWrap}>\r\n        <img className={styles.img} src={src} alt=\"\" />\r\n      </div>\r\n      <div className={styles.content}>\r\n        <h3 className={styles.title}>{title}</h3>\r\n        <div className={styles.desc}>{desc}</div>\r\n        <div>\r\n          {/* ['近地铁', '随时看房'] */}\r\n          {tags.map((tag, index) => {\r\n            const tagClass = \"tag\" + (index + 1);\r\n            return (\r\n              <span\r\n                className={[styles.tag, styles[tagClass]].join(\" \")}\r\n                key={tag}\r\n              >\r\n                {tag}\r\n              </span>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className={styles.price}>\r\n          <span className={styles.priceNum}>{price}</span> 元/月\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nHouseItem.propTypes = {\r\n  // src: PropTypes.string,\r\n  // title: PropTypes.string,\r\n  // desc: PropTypes.string,\r\n  // tags: PropTypes.array.isRequired,\r\n  // price: PropTypes.number,\r\n  // onClick: PropTypes.func\r\n};\r\n\r\nexport default HouseItem;\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"house\":\"HouseItem_house__2q9Ye\",\"imgWrap\":\"HouseItem_imgWrap__xEh5J\",\"img\":\"HouseItem_img__rewGk\",\"content\":\"HouseItem_content__1WkA3\",\"title\":\"HouseItem_title__2o3S7\",\"desc\":\"HouseItem_desc__1k7nO\",\"price\":\"HouseItem_price__1_VPA\",\"priceNum\":\"HouseItem_priceNum__3oYx1\",\"tag\":\"HouseItem_tag__1bClN\",\"tag1\":\"HouseItem_tag1__3oa-D\",\"tag2\":\"HouseItem_tag2__1_RYT\",\"tag3\":\"HouseItem_tag3__26E0o\"};","import api from \"../../axios\";\r\n\r\n// 获取房屋查询条件\r\nconst getHousesCondition = (id) => {\r\n  return api.get(\"/houses/condition\", {\r\n    params: {\r\n      id,\r\n    },\r\n  });\r\n};\r\n\r\n// 根据条件查询房屋\r\nconst getHouses = (cityId, filters, start, end) => {\r\n  return api.get(\"/houses\", {\r\n    params: {\r\n      cityId,\r\n      ...filters,\r\n      start,\r\n      end,\r\n    },\r\n  });\r\n};\r\n\r\n// 查询房屋具体信息\r\nconst getHousesById = (id) => {\r\n  return api.get(`/houses/${id}`);\r\n};\r\n\r\nexport { getHousesCondition, getHouses, getHousesById };\r\n"],"sourceRoot":""}