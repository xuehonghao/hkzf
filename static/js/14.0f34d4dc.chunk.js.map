{"version":3,"sources":["components/HousePackage/index.js","components/HousePackage/index.module.css","utils/axios.js","utils/currentCity.js","pages/Rent/Add/index.module.css","pages/Rent/Add/index.js","utils/api/plugin/index.js","utils/api/area/index.js","utils/api/user/index.js"],"names":["HOUSE_PACKAGE","id","name","icon","HousePackage","state","selectedNames","toggleSelect","newSelectedNames","indexOf","filter","item","props","onSelect","setState","console","log","this","data","split","select","list","v","includes","map","isSelected","key","className","styles","active","join","onClick","root","renderItems","Component","module","exports","BaseURL","api","axios","create","baseURL","interceptors","request","use","config","url","headers","startsWith","authorization","getToken","loading","error","Promise","reject","response","res","status","description","body","hide","setToken","localStorage","setItem","getItem","removeToken","removeItem","isAuth","setSession","sessionStorage","JSON","stringify","getSession","currCity","parse","getCurrCity","a","currCityByLocal","resolve","window","BMap","LocalCity","get","result","currCityByMap","resove","getCityInfo","alert","roomTypeData","label","value","orientedData","floorData","RentAdd","onCancel","text","onPress","history","go","getValue","getImg","files","operationType","index","tempSlides","selPack","selNames","supporting","addHouse","title","oriented","price","roomType","size","floor","community","info","length","fm","FormData","forEach","append","file","post","houseImg","fail","otd","pubHouse","ores","success","replace","push","pathname","backUrl","location","com","Item","navHeader","mode","type","onLeftClick","header","renderHeader","data-role","extra","arrow","placeholder","onChange","cols","pics","multiple","imgpicker","desc","rows","autoHeight","bottom","cancel","confirm","params","getCities","level","getHotCity","getCommunity","getMapHouses","login","username","password","getUserInfo","logout","getHousesFav","delFav","delete","addFav","getUserHouses"],"mappings":"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","file":"static/js/14.0f34d4dc.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\n\r\nimport styles from \"./index.module.css\";\r\n\r\n// 所有房屋配套数据和图标\r\nconst HOUSE_PACKAGE = [\r\n  {\r\n    id: 1,\r\n    name: \"衣柜\",\r\n    icon: \"icon-wardrobe\",\r\n  },\r\n  {\r\n    id: 2,\r\n    name: \"洗衣机\",\r\n    icon: \"icon-wash\",\r\n  },\r\n  {\r\n    id: 3,\r\n    name: \"空调\",\r\n    icon: \"icon-air\",\r\n  },\r\n  {\r\n    id: 4,\r\n    name: \"天然气\",\r\n    icon: \"icon-gas\",\r\n  },\r\n  {\r\n    id: 5,\r\n    name: \"冰箱\",\r\n    icon: \"icon-ref\",\r\n  },\r\n  {\r\n    id: 6,\r\n    name: \"暖气\",\r\n    icon: \"icon-Heat\",\r\n  },\r\n  {\r\n    id: 7,\r\n    name: \"电视\",\r\n    icon: \"icon-vid\",\r\n  },\r\n  {\r\n    id: 8,\r\n    name: \"热水器\",\r\n    icon: \"icon-heater\",\r\n  },\r\n  {\r\n    id: 9,\r\n    name: \"宽带\",\r\n    icon: \"icon-broadband\",\r\n  },\r\n  {\r\n    id: 10,\r\n    name: \"沙发\",\r\n    icon: \"icon-sofa\",\r\n  },\r\n];\r\n\r\n/* \r\n  该组件的两种功能：\r\n  1 根据传入的 list 展示房屋配置列表（房源详情页面）\r\n    <HousePackage list={['衣柜', '洗衣机']} />\r\n  2 从所有配置列表中选择房屋配置（发布房源页面）\r\n    <HousePackage select onSelect={selectedItems => {...}} />\r\n*/\r\nexport default class HousePackage extends Component {\r\n  state = {\r\n    // 选中名称\r\n    selectedNames: [],\r\n  };\r\n\r\n  componentDidMount() {\r\n    // debugger\r\n    console.log(\"====================================\");\r\n    console.log(this.props);\r\n    console.log(\"====================================\");\r\n    if (!!this.props.data) {\r\n      this.setState({\r\n        selectedNames: this.props.data.split(\"|\"),\r\n      });\r\n    }\r\n  }\r\n\r\n  // 根据id切换选中状态\r\n  toggleSelect = (name) => {\r\n    const { selectedNames } = this.state;\r\n    let newSelectedNames;\r\n\r\n    // 判断该项是否选中\r\n    if (selectedNames.indexOf(name) > -1) {\r\n      // 选中：从数组中删除选中项，也就是保留未选中项\r\n      newSelectedNames = selectedNames.filter((item) => item !== name);\r\n    } else {\r\n      // 未选中：添加到数组中\r\n      newSelectedNames = [...selectedNames, name];\r\n    }\r\n\r\n    // 传递给父组件\r\n    this.props.onSelect(newSelectedNames);\r\n\r\n    this.setState({\r\n      selectedNames: newSelectedNames,\r\n    });\r\n  };\r\n\r\n  // 渲染列表项\r\n  renderItems() {\r\n    const { selectedNames } = this.state;\r\n    // select 的值为 true 表示 选择房屋配置；false 表示仅展示房屋列表\r\n    // list 表示要展示的列表项\r\n    const { select, list } = this.props;\r\n\r\n    let data;\r\n    // 如果传了 select 表示：选择 房屋配置\r\n    // 如果没传 select 表示：展示 房屋配置 列表\r\n    if (select) {\r\n      data = HOUSE_PACKAGE;\r\n    } else {\r\n      // 展示房屋配置列表\r\n      // 从所有的列表项中过滤出要展示的（list）列表项\r\n      data = HOUSE_PACKAGE.filter((v) => list.includes(v.name));\r\n    }\r\n\r\n    return data.map((item) => {\r\n      // 判断该项是否选中\r\n      const isSelected = selectedNames.indexOf(item.name) > -1;\r\n\r\n      return (\r\n        <li\r\n          key={item.id}\r\n          className={[styles.item, isSelected ? styles.active : \"\"].join(\" \")}\r\n          onClick={select && (() => this.toggleSelect(item.name))}\r\n        >\r\n          <p>\r\n            <i className={`iconfont ${item.icon} ${styles.icon}`} />\r\n          </p>\r\n          {item.name}\r\n        </li>\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return <ul className={styles.root}>{this.renderItems()}</ul>;\r\n  }\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"HousePackage_root__3QhnK\",\"item\":\"HousePackage_item__1DXwr\",\"active\":\"HousePackage_active__3MP_v\",\"icon\":\"HousePackage_icon__1ccEw\"};","import axios from \"axios\";\r\nimport { Toast } from \"antd-mobile\";\r\nimport { getToken } from \"./currentCity\";\r\n\r\n// 基地址\r\nconst BaseURL = \"https://api-haoke-web.itheima.net\";\r\n\r\nconst api = axios.create({\r\n  baseURL: BaseURL,\r\n});\r\n\r\n// Add a request interceptor  请求拦截器\r\napi.interceptors.request.use(\r\n  function (config) {\r\n    const { url, headers } = config;\r\n    const list = [\"/user/registered\", \"/user/login\"]; // 白名单\r\n\r\n    if (url.startsWith(\"/user\") && !list.includes(url)) {\r\n      // 设置公共请求头\r\n      headers.authorization = getToken();\r\n    }\r\n\r\n    // 动画加载\r\n    Toast.loading(\"加载中...\", 0);\r\n    // Do something before request is sent\r\n    return config;\r\n  },\r\n  function (error) {\r\n    // Do something with request error\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add a response interceptor  响应拦截器\r\napi.interceptors.response.use(\r\n  function (response) {\r\n    // 简化返回结果\r\n    let res = {\r\n      status: response.data.status,\r\n      description: response.data.description,\r\n      data: response.data.body,\r\n    };\r\n    // 动画结束\r\n    Toast.hide();\r\n    return res;\r\n  },\r\n  function (error) {\r\n    // Any status codes that falls outside the range of 2xx cause this function to trigger\r\n    // Do something with response error\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\nexport { BaseURL };\r\n","import { getCityInfo } from \"./api/area\";\r\n\r\nconst CURR_CITY = \"currCity\"; // 当前城市\r\nconst USER_TOKEN = \"token\";\r\n\r\n// 设置Token\r\nconst setToken = (data) => {\r\n  localStorage.setItem(USER_TOKEN, data);\r\n};\r\n\r\n// 获取Token\r\nconst getToken = () => {\r\n  let token = localStorage.getItem(USER_TOKEN);\r\n  return token;\r\n};\r\n\r\n// 删除Token\r\nconst removeToken = () => {\r\n  localStorage.removeItem(USER_TOKEN);\r\n};\r\n\r\n// 是否登录判断：boolean\r\nconst isAuth = () => !!getToken();\r\n\r\n// 设置当前城市\r\nconst setSession = (data) => {\r\n  sessionStorage.setItem(CURR_CITY, JSON.stringify(data));\r\n};\r\n\r\n// 获取当前城市\r\nconst getSession = () => {\r\n  let currCity = sessionStorage.getItem(CURR_CITY);\r\n  if (!!!currCity) return null;\r\n  return JSON.parse(currCity);\r\n};\r\n\r\n// 删除当前城市\r\n// const removeSession = () => {\r\n//   sessionStorage.removeItem(CURR_CITY);\r\n// };\r\n\r\n// 百度获取\r\nconst getCurrCityByMap = () => {\r\n  return new Promise((resolve, reject) => {\r\n    // 使用百度地图LocalCity获取当前的城市名称\r\n    const myCity = new window.BMap.LocalCity();\r\n    myCity.get((result) => {\r\n      // 根据百度地图获取到城市名字，调用后台接口获取当前城市的详细数据\r\n      resolve(result.name);\r\n    });\r\n  });\r\n};\r\n\r\n// 获取当前城市信息\r\nconst getCurrCity = async () => {\r\n  // 内存中找\r\n  const currCityByLocal = getSession();\r\n\r\n  // 定位\r\n  const currCityByMap = await getCurrCityByMap();\r\n  // 内存中没有 || 内存中有键没值 || 定位和内存中的值不匹配  这样判断，手动切换城市就会有bug\r\n  // if (\r\n  //   !currCityByLocal ||\r\n  //   !currCityByLocal.label ||\r\n  //   !currCityByMap.includes(currCityByLocal.label)\r\n  // ) {\r\n\r\n  if (!currCityByLocal) {\r\n    return new Promise(async (resove, reject) => {\r\n      // 调用接口获取城市详细信息\r\n      const { status, data } = await getCityInfo(currCityByMap);\r\n      if (status === 200) {\r\n        // 存到本地\r\n        setSession(data);\r\n        // 传递数据\r\n        resove(data);\r\n      } else {\r\n        reject(\"error\");\r\n      }\r\n    });\r\n  } else {\r\n    // 如果有，返回本地存储获取的信息\r\n    return Promise.resolve(currCityByLocal);\r\n  }\r\n};\r\n\r\nexport {\r\n  getCurrCity,\r\n  setSession,\r\n  CURR_CITY,\r\n  setToken,\r\n  getToken,\r\n  removeToken,\r\n  isAuth,\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Add_root__2Zl1r\",\"bottom\":\"Add_bottom__1vkez\",\"cancel\":\"Add_cancel__2yDMH\",\"imgpicker\":\"Add_imgpicker__1kIq-\",\"input\":\"Add_input__1XrVz\",\"label\":\"Add_label__23ISk\",\"confirm\":\"Add_confirm__ko97n\",\"title\":\"Add_title__3ILYp\",\"pics\":\"Add_pics__1URKg\",\"supporting\":\"Add_supporting__2evC7\",\"desc\":\"Add_desc__2KgHr\"};","import React, { Component } from \"react\";\r\n\r\nimport {\r\n  Flex,\r\n  List,\r\n  InputItem,\r\n  Picker,\r\n  ImagePicker,\r\n  TextareaItem,\r\n  Modal,\r\n  NavBar,\r\n  Icon,\r\n  Toast,\r\n} from \"antd-mobile\";\r\n\r\nimport HousePackage from \"../../../components/HousePackage\";\r\n\r\nimport styles from \"./index.module.css\";\r\n\r\nimport { uploadHouseImgs } from \"../../../utils/api/plugin\";\r\nimport { pubHouse } from \"../../../utils/api/user\";\r\n\r\nconst alert = Modal.alert;\r\n\r\n// 房屋类型\r\nconst roomTypeData = [\r\n  { label: \"一室\", value: \"ROOM|d4a692e4-a177-37fd\" },\r\n  { label: \"二室\", value: \"ROOM|d1a00384-5801-d5cd\" },\r\n  { label: \"三室\", value: \"ROOM|20903ae0-c7bc-f2e2\" },\r\n  { label: \"四室\", value: \"ROOM|ce2a5daa-811d-2f49\" },\r\n  { label: \"四室+\", value: \"ROOM|2731c38c-5b19-ff7f\" },\r\n];\r\n\r\n// 朝向：\r\nconst orientedData = [\r\n  { label: \"东\", value: \"ORIEN|141b98bf-1ad0-11e3\" },\r\n  { label: \"西\", value: \"ORIEN|103fb3aa-e8b4-de0e\" },\r\n  { label: \"南\", value: \"ORIEN|61e99445-e95e-7f37\" },\r\n  { label: \"北\", value: \"ORIEN|caa6f80b-b764-c2df\" },\r\n  { label: \"东南\", value: \"ORIEN|dfb1b36b-e0d1-0977\" },\r\n  { label: \"东北\", value: \"ORIEN|67ac2205-7e0f-c057\" },\r\n  { label: \"西南\", value: \"ORIEN|2354e89e-3918-9cef\" },\r\n  { label: \"西北\", value: \"ORIEN|80795f1a-e32f-feb9\" },\r\n];\r\n\r\n// 楼层\r\nconst floorData = [\r\n  { label: \"高楼层\", value: \"FLOOR|1\" },\r\n  { label: \"中楼层\", value: \"FLOOR|2\" },\r\n  { label: \"低楼层\", value: \"FLOOR|3\" },\r\n];\r\n\r\nexport default class RentAdd extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      // 临时图片地址\r\n      tempSlides: [],\r\n\r\n      // 小区的名称和id\r\n      community: {\r\n        name: \"\",\r\n        id: \"\",\r\n      },\r\n      // 价格\r\n      price: \"\",\r\n      // 面积\r\n      size: \"\",\r\n      // 房屋类型\r\n      roomType: \"\",\r\n      // 楼层\r\n      floor: \"\",\r\n      // 朝向：\r\n      oriented: \"\",\r\n      // 房屋标题\r\n      title: \"\",\r\n      // 房屋图片\r\n      houseImg: \"\",\r\n      // 房屋配套：\r\n      supporting: \"\",\r\n      // 房屋描述\r\n      description: \"\",\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { id, name, data } = this.props.location;\r\n    // 获取之前的数据\r\n    if (!!data) {\r\n      this.setState({\r\n        ...data,\r\n      });\r\n    }\r\n    // 设置小区名称\r\n    if (!!id && !!name) {\r\n      const com = {};\r\n      com.name = name;\r\n      com.id = id;\r\n      this.setState({\r\n        community: com,\r\n      });\r\n    }\r\n  }\r\n\r\n  // 取消编辑，返回上一页\r\n  onCancel = () => {\r\n    alert(\"提示\", \"放弃发布房源?\", [\r\n      {\r\n        text: \"放弃\",\r\n        onPress: async () => this.props.history.go(-1),\r\n      },\r\n      {\r\n        text: \"继续编辑\",\r\n      },\r\n    ]);\r\n  };\r\n\r\n  // 获取表单输入值\r\n  getValue = (name, v) => {\r\n    console.log(name, v);\r\n    this.setState({\r\n      [name]: v,\r\n    });\r\n  };\r\n\r\n  // 获取房屋图片\r\n  // files: Object, operationType: string, index: number\r\n  getImg = (files, operationType, index) => {\r\n    console.log(files, operationType, index);\r\n    this.setState({\r\n      tempSlides: files,\r\n    });\r\n  };\r\n\r\n  // 选择配套\r\n  selPack = (selNames) => {\r\n    console.log(selNames);\r\n    this.setState({\r\n      supporting: selNames.join(\"|\"),\r\n    });\r\n  };\r\n\r\n  // 发布房源\r\n  addHouse = async () => {\r\n    const {\r\n      tempSlides,\r\n      title,\r\n      description,\r\n      oriented,\r\n      supporting,\r\n      price,\r\n      roomType,\r\n      size,\r\n      floor,\r\n      community,\r\n    } = this.state;\r\n    // 处理边界\r\n    if (!title || !size || !price) {\r\n      return Toast.info(\"请输入房源的基本信息！\", 1);\r\n    }\r\n    // 上传图片，获取上传位置\r\n    let houseImg;\r\n    if (tempSlides.length) {\r\n      let fm = new FormData();\r\n      tempSlides.forEach((item) => fm.append(\"file\", item.file));\r\n      let res = await uploadHouseImgs(fm);\r\n      console.log(res);\r\n      if (res.status === 200) {\r\n        houseImg = res.data.join(\"|\");\r\n      } else {\r\n        Toast.fail(res.description, 2);\r\n      }\r\n    }\r\n    // 处理其它数据\r\n    const otd = {\r\n      title,\r\n      description,\r\n      houseImg,\r\n      oriented,\r\n      supporting,\r\n      price,\r\n      roomType,\r\n      size,\r\n      floor,\r\n      community: community.id,\r\n    };\r\n    let ores = await pubHouse(otd);\r\n    console.log(\"form all data:\", otd);\r\n    if (ores.status === 200) {\r\n      Toast.success(\"发布成功！\", 1, () => {\r\n        this.props.history.replace(\"/rent\");\r\n      });\r\n    } else {\r\n      if (ores.status === 400) {\r\n        Toast.info(\"请重新登录！\", 1, () => {\r\n          // 传入回跳地址\r\n          this.props.history.push({\r\n            pathname: \"/login\",\r\n            backUrl: this.props.location.pathname,\r\n          });\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const Item = List.Item;\r\n    const { history } = this.props;\r\n    const {\r\n      community,\r\n      price,\r\n      size,\r\n      roomType,\r\n      floor,\r\n      oriented,\r\n      description,\r\n      tempSlides,\r\n      title,\r\n    } = this.state;\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        <NavBar\r\n          className={styles.navHeader}\r\n          mode=\"dark\"\r\n          icon={<Icon type=\"left\" />}\r\n          onLeftClick={this.onCancel}\r\n        >\r\n          发布房源\r\n        </NavBar>\r\n        <List\r\n          className={styles.header}\r\n          renderHeader={() => \"基本信息\"}\r\n          data-role=\"rent-list\"\r\n        >\r\n          {/* 选择所在小区 */}\r\n          <Item\r\n            extra={community.name || \"请选择小区名称\"}\r\n            arrow=\"horizontal\"\r\n            onClick={() =>\r\n              history.replace({ pathname: \"/rent/search\", data: this.state })\r\n            }\r\n          >\r\n            小区名称\r\n          </Item>\r\n          <InputItem\r\n            placeholder=\"请输入租金/月\"\r\n            extra=\"￥/月\"\r\n            type=\"number\"\r\n            value={price}\r\n            onChange={(v) => this.getValue(\"price\", v)}\r\n          >\r\n            租&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;金\r\n          </InputItem>\r\n          <InputItem\r\n            placeholder=\"请输入建筑面积\"\r\n            extra=\"㎡\"\r\n            type=\"number\"\r\n            value={size}\r\n            onChange={(v) => this.getValue(\"size\", v)}\r\n          >\r\n            建筑面积\r\n          </InputItem>\r\n          <Picker\r\n            data={roomTypeData}\r\n            value={[roomType]}\r\n            cols={1}\r\n            onChange={(v) => this.getValue(\"roomType\", v[0])}\r\n          >\r\n            <Item arrow=\"horizontal\">\r\n              户&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;型\r\n            </Item>\r\n          </Picker>\r\n\r\n          <Picker\r\n            data={floorData}\r\n            value={[floor]}\r\n            cols={1}\r\n            onChange={(v) => this.getValue(\"floor\", v[0])}\r\n          >\r\n            <Item arrow=\"horizontal\">所在楼层</Item>\r\n          </Picker>\r\n          <Picker\r\n            data={orientedData}\r\n            value={[oriented]}\r\n            cols={1}\r\n            onChange={(v) => this.getValue(\"oriented\", v[0])}\r\n          >\r\n            <Item arrow=\"horizontal\">\r\n              朝&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;向\r\n            </Item>\r\n          </Picker>\r\n        </List>\r\n\r\n        <List\r\n          className={styles.title}\r\n          renderHeader={() => \"房屋标题\"}\r\n          data-role=\"rent-list\"\r\n        >\r\n          <InputItem\r\n            placeholder=\"请输入标题（例如：整租 小区名 2室 5000元）\"\r\n            value={title}\r\n            onChange={(v) => this.getValue(\"title\", v)}\r\n          />\r\n        </List>\r\n\r\n        <List\r\n          className={styles.pics}\r\n          renderHeader={() => \"房屋图像\"}\r\n          data-role=\"rent-list\"\r\n        >\r\n          <ImagePicker\r\n            files={tempSlides}\r\n            multiple={true}\r\n            className={styles.imgpicker}\r\n            onChange={this.getImg}\r\n          />\r\n        </List>\r\n\r\n        <List\r\n          className={styles.supporting}\r\n          renderHeader={() => \"房屋配置\"}\r\n          data-role=\"rent-list\"\r\n        >\r\n          <HousePackage\r\n            select\r\n            onSelect={this.selPack}\r\n            data={this.props.location.data?.supporting}\r\n          />\r\n        </List>\r\n\r\n        <List\r\n          className={styles.desc}\r\n          renderHeader={() => \"房屋描述\"}\r\n          data-role=\"rent-list\"\r\n        >\r\n          <TextareaItem\r\n            rows={5}\r\n            placeholder=\"请输入房屋描述信息\"\r\n            autoHeight\r\n            value={description}\r\n            onChange={(v) => this.getValue(\"description\", v)}\r\n          />\r\n        </List>\r\n\r\n        <Flex className={styles.bottom}>\r\n          <Flex.Item className={styles.cancel} onClick={this.onCancel}>\r\n            取消\r\n          </Flex.Item>\r\n          <Flex.Item className={styles.confirm} onClick={this.addHouse}>\r\n            提交\r\n          </Flex.Item>\r\n        </Flex>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import api from \"../../axios\";\r\n\r\nconst uploadHouseImgs = (file) => {\r\n  return api.post(\"/houses/image\", file, {\r\n    headers: {\r\n      \"Content-Type\": \"multipart/form-data\",\r\n    },\r\n  });\r\n};\r\n\r\nexport { uploadHouseImgs };\r\n","import api from \"../../axios\";\r\n\r\n// 根据城市名称查询该城市的信息\r\nconst getCityInfo = (name) => {\r\n  return api.get(\"/area/info\", {\r\n    params: {\r\n      name,\r\n    },\r\n  });\r\n};\r\n\r\n// 获取城市列表数据\r\nconst getCities = (level = 1) => {\r\n  return api.get(\"/area/city\", {\r\n    params: {\r\n      level,\r\n    },\r\n  });\r\n};\r\n\r\n// 获取热门城市\r\nconst getHotCity = () => {\r\n  return api.get(\"/area/hot\");\r\n};\r\n\r\n// 小区关键词查询\r\nconst getCommunity = (name, id) => {\r\n  return api.get(\"/area/community\", {\r\n    params: {\r\n      name,\r\n      id,\r\n    },\r\n  });\r\n};\r\n\r\n// 查询房源数据\r\nconst getMapHouses = (id) => {\r\n  return api.get(\"/area/map\", {\r\n    params: {\r\n      id,\r\n    },\r\n  });\r\n};\r\n\r\nexport { getCityInfo, getCities, getHotCity, getCommunity, getMapHouses };\r\n","import api from \"../../axios\";\r\n\r\n// 用户登录接口\r\nconst login = (username, password) => {\r\n  return api.post(\"/user/login\", {\r\n    username,\r\n    password,\r\n  });\r\n};\r\n\r\n// 获取用户的信息资料\r\nconst getUserInfo = () => {\r\n  return api.get(\"/user\");\r\n};\r\n\r\n// 用户退出登录\r\nconst logout = () => {\r\n  return api.post(\"/user/logout\");\r\n};\r\n\r\n// 房屋是否收藏\r\nconst getHousesFav = (id) => {\r\n  return api.get(`/user/favorites/${id}`);\r\n};\r\n\r\n// 删除收藏\r\nconst delFav = (id) => {\r\n  return api.delete(`/user/favorites/${id}`);\r\n};\r\n\r\n// 添加收藏\r\nconst addFav = (id) => {\r\n  return api.post(`/user/favorites/${id}`);\r\n};\r\n\r\n// 查看已发布房源列表\r\nconst getUserHouses = () => {\r\n  return api.get(\"/user/houses\");\r\n};\r\n\r\n// 发布房源\r\nconst pubHouse = (body) => {\r\n  return api.post(\"/user/houses\", {\r\n    ...body,\r\n  });\r\n};\r\n\r\nexport {\r\n  login,\r\n  getUserInfo,\r\n  logout,\r\n  getHousesFav,\r\n  delFav,\r\n  addFav,\r\n  getUserHouses,\r\n  pubHouse,\r\n};\r\n"],"sourceRoot":""}